<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stijn Masschelein">

<title>Method Package - Interpretation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../generalised/poisson.html" rel="next">
<link href="../generalised/introduction.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../generalised/introduction.html">Generalised Linear Models</a></li><li class="breadcrumb-item"><a href="../generalised/interpretation.html">Interpretation</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Method Package</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../method_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Content</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../auxilary/introduction_to_r_rstudio_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rstudio installation and first code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../auxilary/introduction_to_rstudio_for_accfin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Rstudio for Accounting and Finance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Research Methods in Finance and Accounting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulations, Regressions, and Significance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Design 1: Fixed Effects and Instrumental Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Design 2: Event Studies and Difference-in-Difference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/slides_proposal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feedback on Pitch and Proposal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../auxilary/matching_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matching theory</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Friday Earnings Announcements</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/download_linking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WRDS linking data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/linking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Combining databases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/download_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Earnings announcements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/download_stocks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stock price data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/abnormal_returns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abnormal returns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../freaky_friday/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../machine_learning/predictions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../machine_learning/theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../machine_learning/application.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Peer Firms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../machine_learning/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Generalised Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalised/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction and Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalised/interpretation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Interpretation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generalised/poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Generated Variables</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generated/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generated/residual_dependent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Independent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generated/inverse_probability_weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IPW</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#the-problem" id="toc-the-problem" class="nav-link" data-scroll-target="#the-problem">The problem</a></li>
  <li><a href="#why-does-it-matter" id="toc-why-does-it-matter" class="nav-link" data-scroll-target="#why-does-it-matter">Why does it matter?</a></li>
  </ul></li>
  <li><a href="#solution-without-controls" id="toc-solution-without-controls" class="nav-link" data-scroll-target="#solution-without-controls">Solution without controls</a>
  <ul class="collapse">
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">Linear model</a></li>
  <li><a href="#marginal-effects" id="toc-marginal-effects" class="nav-link" data-scroll-target="#marginal-effects">Marginal Effects</a></li>
  </ul></li>
  <li><a href="#solution-with-controls" id="toc-solution-with-controls" class="nav-link" data-scroll-target="#solution-with-controls">Solution with controls</a>
  <ul class="collapse">
  <li><a href="#solution-with-continuous-variable" id="toc-solution-with-continuous-variable" class="nav-link" data-scroll-target="#solution-with-continuous-variable">Solution with continuous variable</a></li>
  </ul></li>
  <li><a href="#further-information" id="toc-further-information" class="nav-link" data-scroll-target="#further-information">Further information</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Interpretation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stijn Masschelein </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell" data-hash="interpretation_cache/html/setup_cc1c5f49250c95f875a166abf781316f">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_cowplot</span>(<span class="at">font_size =</span> <span class="dv">18</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">i_am</span>(<span class="st">"generalised/introduction.qmd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/stijnmasschelein/Library/CloudStorage/Dropbox/Teaching/lecturenotes/method_package</code></pre>
</div>
</div>
<div class="cell" data-hash="interpretation_cache/html/parameters_52ab3fc7b975bf30830d497ffc5bcc40">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1001</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>gof_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"nobs"</span>, <span class="st">"r.squared"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">230383</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<section id="the-problem" class="level3">
<h3 class="anchored" data-anchor-id="the-problem">The problem</h3>
<p>The problem with non-linear, generalised linear models is that the interpretation of the coefficients is more murky than in our linear models. In a linear model, we can interpret the coefficient, <span class="math inline">\(\beta\)</span>, of the variable <span class="math inline">\(x\)</span> easily. When <span class="math inline">\(x\)</span> is a continuous variable, we can interpret the coefficient as the increase in <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> increases by 1. When <span class="math inline">\(x\)</span> indicates whether an observation is in the treatment group (<span class="math inline">\(x=1\)</span>) or in the control group (<span class="math inline">\(x=0\)</span>), the coefficient estimates the difference between the control and treatment group for <span class="math inline">\(y\)</span>.</p>
<p>Unfortunately, the non-linear transformation for the generalised linear models complicates the interpretation. Let’s illustrate this with an example where we know the true model for the probability that a firm has a female CEO (<span class="math inline">\(y_1\)</span>) and the probability that the firm has a female CFO (<span class="math inline">\(y_2\)</span>). The true probabilities are given by the following logistic models.</p>
<p><span class="math display">\[
\begin{aligned}
y_1 &amp;= \frac{e^{2 + 3x}}{1 + e^{2 + 3x}} &amp;&amp;= g(2 + 3x) \\
y_2 &amp;= \frac{e^{-2 + 3x}}{1 + e^{-2 + 3x}} &amp;&amp;= g(-2 + 3x)
\end{aligned}
\]</span></p>
<p>You can think of <span class="math inline">\(x\)</span> as a characteristic of the company that increases the likelihood of female executives in the company. A casual glance of the equations would give the impression that the effect of the characteristic on the CEOs and CFOs is the same because <span class="math inline">\(\beta = 3\)</span> is the same in both equations. We can also plot the two probabilities as functions of <span class="math inline">\(x\)</span> and you can see that that one curve is just the other one shifted horizontally.</p>
<div class="cell" data-hash="interpretation_cache/html/interpretation_8b84e881c666636b1d29cc4132d25dbe">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>interpretation <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y1 =</span> <span class="fu">plogis</span>(<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y2 =</span> <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>interpretation <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y1, y2)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">x =</span> x,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">colour =</span> name)) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/interpretation-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>However, from the plots you can already see that firms at <span class="math inline">\(x = 0\)</span> will see a larger increase in the probability of having a female CFO (<span class="math inline">\(y_2\)</span>) than a female CEO (<span class="math inline">\(y_1\)</span>) when <span class="math inline">\(x\)</span> increases. Because at <span class="math inline">\(x=0\)</span> most firms are already more likely to have a female CEO and thus the effect of <span class="math inline">\(x\)</span> cannot be very large. In other words, despite the fact that the two probabilities follow a very similar function, the effect of an increase in <span class="math inline">\(x\)</span> can be very different depending on the value of <span class="math inline">\(x\)</span>.</p>
<p>Another way to look at the problem is to think of <span class="math inline">\(x\)</span> as a policy that is either present (<span class="math inline">\(x=1\)</span>) or not (<span class="math inline">\(x=0\)</span>). We can calculate the causal effect of the policy as follows.</p>
<div class="cell" data-hash="interpretation_cache/html/unnamed-chunk-4_581c0f035bb8860f436d6c306d7668ad">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>y1_effect <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">plogis</span>(<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y2_effect <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(y1_effect, y2_effect))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1125101 0.6118557</code></pre>
</div>
</div>
<p>Again, we see that the policy has a large effect (0.61) for <span class="math inline">\(y_2\)</span> and a small effect for <span class="math inline">\(y_1\)</span> (0.11).</p>
</section>
<section id="why-does-it-matter" class="level3">
<h3 class="anchored" data-anchor-id="why-does-it-matter">Why does it matter?</h3>
<p>There are a number of reasons when this will matter. First of all, the coefficient (<span class="math inline">\(\beta = 3\)</span>) does not directly map onto the causal effect. The same coefficient can lead to <em>different causal effects</em> depending on the value of <span class="math inline">\(x\)</span> and depending on other parts of the model (e.g.&nbsp;the intercept). That means that we cannot just rely on the coefficient.</p>
<p>Because the true effect depends on <em>other parts</em> of the model, generalised linear models make the use of fixed effects and robust standard errors more tricky as well. I am not going to go into the details of these issues but that is the overall problem with generalised linear model: the effect of each term is dependent on the other parts of the model.</p>
<p>There are two questions to ask whether this is a problem for your research question.</p>
<ol type="1">
<li><p>The first question is whether you are interested in predicting the variable <span class="math inline">\(y\)</span> or whether you are interested in estimating an effect on the variable <span class="math inline">\(y\)</span>. As I discussed in the <a href="../machine_learning/predictions.html">introduction to machine learning</a>, when we are mainly interested in prediction, the coefficients or effects are less important. In the case of predictions, we definitely want to use a model that does not allow to make impossible predictions (e.g.&nbsp;probabilities that are higher than 1).</p></li>
<li><p>The second question is whether we are interested in the effect on the linear scale (<span class="math inline">\(\alpha + \beta x\)</span>) or on the transformed scale (<span class="math inline">\(g(\alpha + \beta x)\)</span>). In the working example I have used so far, you probably would be interested in the transformed scale, i.e.&nbsp;the <em>probability</em> that the firm has a female CEO. In a lot of cases in accounting and finance, we would be interested directly in those probabilities e.g.&nbsp;the probability that a firm goes bankrupt, or discloses certain information. In contrast, studies in consumer finance or behavioural economics are more interested in the <em>utility</em> that consumers derive from certain interventions. While the utility is often unobserved, we can observe the consumers choices (e.g.&nbsp;which mortgage they choose). A typical approach is to model the unobserved utility on the a linear scale (<span class="math inline">\(z\)</span>) and model the probability of a choice as a transformation of the utility (<span class="math inline">\(g(z)\)</span>). In fact, the logistic transformation is the workhorse function in this literature. Finally, there is literature that prefers the linear scale for logistic models because they argue that we can interpret the effects on the <em>log odds scale</em>, <span class="math inline">\(\textrm{log}(\frac{p}{1-p})\)</span>. That is, the effect on the linear scale represents an effect on the relative probability.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Betting markets often present winning probabilities as odds or relative probabilities.</p></li>
</ol>
</section>
</section>
<section id="solution-without-controls" class="level2">
<h2 class="anchored" data-anchor-id="solution-without-controls">Solution without controls</h2>
<p>In the next, section I am going to assume that we are only interested in the effect on the probability scale and we would like to summarise the effect in one number. We will start with the simplest case where the variable of interest is a simple treatment (<span class="math inline">\(x = 1\)</span>) versus control (<span class="math inline">\(x = 0\)</span>). We generate data according to the two functions above. In this simple case, it’s relatively easy to estimate the causal effects by just looking at the difference between the treatment and the control condition for both variables.</p>
<div class="cell" data-hash="interpretation_cache/html/solutions-data_3259f74ba15e2a9b77c56264f36d5fdc">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>solutions <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y1 =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x)),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y2 =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x)))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>solutions <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(y1, y2), mean), <span class="at">.by =</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
      x    y1    y2
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1 0.986 0.708
2     0 0.886 0.136</code></pre>
</div>
</div>
<p>You can see that the differences are pretty close to the theoretical effects <code>y1_effect</code> = 0.11 and <code>y2_effect</code> = 0.61 that we calculated before.</p>
<section id="linear-model" class="level3">
<h3 class="anchored" data-anchor-id="linear-model">Linear model</h3>
<p>The next step is to figure out which regression approach gives us similar estimates. You can see that the OLS model, where we ignore that the outcome variable is restricted, gives us the estimate that we are interested in. To account for the distribution of the outcome variable, it is a good idea to specify <code>se = "hetero"</code>. This way, <code>feols</code> uses a more robust estimation for the standard errors, accounting for the likely non-normal distribution of the error term.</p>
<p>The code also shows who you can run a logit or probit regression in <code>R</code> with the <code>glm</code> function. The main difference with the <code>lm</code> function is that you need to specify the <code>family</code> of models and the transformation <code>link</code>.</p>
<div class="cell" data-hash="interpretation_cache/html/solutions-regression_9cc1060d99e12d8dd805d8eba3eb7ecb">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ols1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y1 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">se =</span> <span class="st">"hetero"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>logit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y1 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>probit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y1 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ols2 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y2 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">se =</span> <span class="st">"hetero"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>logit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y2 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>probit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y2 <span class="sc">~</span> x, <span class="at">data =</span> solutions, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(<span class="fu">list</span>(<span class="at">ols1 =</span> ols1, <span class="at">logit1 =</span> logit1, <span class="at">probit1 =</span> probit1,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">ols2 =</span> ols2, <span class="at">logit2 =</span> logit2, <span class="at">probit2 =</span> probit2),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">gof_map =</span> gof_map, <span class="at">fmt =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>
      function styleCell_ndj8fwp3t928zb91vvsd(i, j, css_id) {
        var table = document.getElementById("tinytable_ndj8fwp3t928zb91vvsd");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ndj8fwp3t928zb91vvsd');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_ndj8fwp3t928zb91vvsd(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ndj8fwp3t928zb91vvsd");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 0, 'tinytable_css_idsevqyb8oc1fq4xnxgo6w') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 1, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 2, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 3, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 4, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 5, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(0, 6, 'tinytable_css_idu1hn69i9vkxwxra0uw8v') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 0, 'tinytable_css_idolu9fbjt06ojhwgsso7h') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 1, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 2, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 3, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 4, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 5, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(1, 6, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 0, 'tinytable_css_idolu9fbjt06ojhwgsso7h') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 1, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 2, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 3, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 4, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 5, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(2, 6, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 0, 'tinytable_css_idolu9fbjt06ojhwgsso7h') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 1, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 2, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 3, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 4, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 5, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(3, 6, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 0, 'tinytable_css_idtnsktvkvtrezhn1mi4t5') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 1, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 2, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 3, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 4, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 5, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(4, 6, 'tinytable_css_idk1s3bubu903utncxkqkp') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 0, 'tinytable_css_idolu9fbjt06ojhwgsso7h') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 1, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 2, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 3, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 4, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 5, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(5, 6, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 0, 'tinytable_css_idolu9fbjt06ojhwgsso7h') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 1, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 2, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 3, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 4, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 5, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
window.addEventListener('load', function () { styleCell_ndj8fwp3t928zb91vvsd(6, 6, 'tinytable_css_id4x11g0t8avjno11t8gnc') })
    </script>

    <style>
    .table td.tinytable_css_idsevqyb8oc1fq4xnxgo6w, .table th.tinytable_css_idsevqyb8oc1fq4xnxgo6w {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idu1hn69i9vkxwxra0uw8v, .table th.tinytable_css_idu1hn69i9vkxwxra0uw8v {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idolu9fbjt06ojhwgsso7h, .table th.tinytable_css_idolu9fbjt06ojhwgsso7h {  text-align: left; }
    .table td.tinytable_css_id4x11g0t8avjno11t8gnc, .table th.tinytable_css_id4x11g0t8avjno11t8gnc {  text-align: center; }
    .table td.tinytable_css_idtnsktvkvtrezhn1mi4t5, .table th.tinytable_css_idtnsktvkvtrezhn1mi4t5 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idk1s3bubu903utncxkqkp, .table th.tinytable_css_idk1s3bubu903utncxkqkp {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_ndj8fwp3t928zb91vvsd" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">ols1</th>
                <th scope="col">logit1</th>
                <th scope="col">probit1</th>
                <th scope="col">ols2</th>
                <th scope="col">logit2</th>
                <th scope="col">probit2</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.89  </td>
                  <td>2.05  </td>
                  <td>1.21  </td>
                  <td>0.14  </td>
                  <td>-1.85 </td>
                  <td>-1.10 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.01)</td>
                  <td>(0.14)</td>
                  <td>(0.07)</td>
                  <td>(0.02)</td>
                  <td>(0.13)</td>
                  <td>(0.07)</td>
                </tr>
                <tr>
                  <td>x          </td>
                  <td>0.10  </td>
                  <td>2.22  </td>
                  <td>1.00  </td>
                  <td>0.57  </td>
                  <td>2.73  </td>
                  <td>1.64  </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.02)</td>
                  <td>(0.41)</td>
                  <td>(0.16)</td>
                  <td>(0.03)</td>
                  <td>(0.16)</td>
                  <td>(0.09)</td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.043 </td>
                  <td>      </td>
                  <td>      </td>
                  <td>0.333 </td>
                  <td>      </td>
                  <td>      </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="marginal-effects" class="level3">
<h3 class="anchored" data-anchor-id="marginal-effects">Marginal Effects</h3>
<p>You can get the best of both worlds in this simple case. We can use the non-linear models to give predictions on the probability scale with <code>fitted</code> and then look at the average between the treatment and the control group.</p>
<div class="cell" data-hash="interpretation_cache/html/marginal-effect-by-hand_e13f6c103d00dca65385ebe8ba6a2776">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>solutions <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_logit =</span> <span class="fu">fitted</span>(logit1),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">pred_probit =</span> <span class="fu">fitted</span>(probit1)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">logit =</span> <span class="fu">mean</span>(pred_logit),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">probit =</span> <span class="fu">mean</span>(pred_probit), <span class="at">.by =</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
      x logit probit
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1 0.986  0.986
2     0 0.886  0.886</code></pre>
</div>
</div>
<p>With the regression objects, we can use the <code>marginaleffects</code> package to get these estimates directly.</p>
<div class="cell" data-hash="interpretation_cache/html/marginal-effect_39a07b7f84a882a969fe9d00bb2b3102">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(logit1, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error    z Pr(&gt;|z|)    S  2.5 % 97.5 %
      0.1     0.0152 6.58   &lt;0.001 34.3 0.0705   0.13

Term: x
Type:  response 
Comparison: 1 - 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(probit1, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error    z Pr(&gt;|z|)    S  2.5 % 97.5 %
      0.1     0.0152 6.58   &lt;0.001 34.3 0.0705   0.13

Term: x
Type:  response 
Comparison: 1 - 0</code></pre>
</div>
</div>
</section>
</section>
<section id="solution-with-controls" class="level2">
<h2 class="anchored" data-anchor-id="solution-with-controls">Solution with controls</h2>
<p>Things become more complicated when we introduce control variables. Remember, the effect of a variable is not constant in a non-linear model and it depends on other parts of the model. That means that the size of effect of <code>x</code> depends on the value of the control variable. Below, I simulate a dataset with a discrete control variable that takes three values (-1, 0, 1) with different probabilities. We can then run our three models and report them as before.</p>
<div class="cell" data-hash="interpretation_cache/html/solution-with-controls_5c01873338f0820bd853f11a9605e5ce">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sol_controls <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">control =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), N, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> control)))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>ols_controls <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_controls,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">se =</span> <span class="st">"hetero"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>logit_controls <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_controls,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>probit_controls <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_controls,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(<span class="fu">list</span>(<span class="at">ols =</span> ols_controls, <span class="at">logit =</span> logit_controls,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">probit =</span> probit_controls),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">gof_map =</span> gof_map, <span class="at">fmt =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>
      function styleCell_del9cntppffwshf5ib16(i, j, css_id) {
        var table = document.getElementById("tinytable_del9cntppffwshf5ib16");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_del9cntppffwshf5ib16');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_del9cntppffwshf5ib16(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_del9cntppffwshf5ib16");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(0, 0, 'tinytable_css_iddb5lhubwvrqgy10td5ab') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(0, 1, 'tinytable_css_idf1hl1zk288jopdnc3mdw') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(0, 2, 'tinytable_css_idf1hl1zk288jopdnc3mdw') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(0, 3, 'tinytable_css_idf1hl1zk288jopdnc3mdw') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(1, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(1, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(1, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(1, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(2, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(2, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(2, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(2, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(3, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(3, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(3, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(3, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(4, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(4, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(4, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(4, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(5, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(5, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(5, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(5, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(6, 0, 'tinytable_css_idi929pfpnxfumovy7zxku') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(6, 1, 'tinytable_css_idl9993xl4f6pnbzwgw011') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(6, 2, 'tinytable_css_idl9993xl4f6pnbzwgw011') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(6, 3, 'tinytable_css_idl9993xl4f6pnbzwgw011') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(7, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(7, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(7, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(7, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(8, 0, 'tinytable_css_id2lii2lgumemi8b4nv7vu') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(8, 1, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(8, 2, 'tinytable_css_idedthchnzc0pdpamft8br') })
window.addEventListener('load', function () { styleCell_del9cntppffwshf5ib16(8, 3, 'tinytable_css_idedthchnzc0pdpamft8br') })
    </script>

    <style>
    .table td.tinytable_css_iddb5lhubwvrqgy10td5ab, .table th.tinytable_css_iddb5lhubwvrqgy10td5ab {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idf1hl1zk288jopdnc3mdw, .table th.tinytable_css_idf1hl1zk288jopdnc3mdw {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id2lii2lgumemi8b4nv7vu, .table th.tinytable_css_id2lii2lgumemi8b4nv7vu {  text-align: left; }
    .table td.tinytable_css_idedthchnzc0pdpamft8br, .table th.tinytable_css_idedthchnzc0pdpamft8br {  text-align: center; }
    .table td.tinytable_css_idi929pfpnxfumovy7zxku, .table th.tinytable_css_idi929pfpnxfumovy7zxku {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idl9993xl4f6pnbzwgw011, .table th.tinytable_css_idl9993xl4f6pnbzwgw011 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_del9cntppffwshf5ib16" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">ols</th>
                <th scope="col">logit</th>
                <th scope="col">probit</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.25  </td>
                  <td>-2.00 </td>
                  <td>-1.11 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.02)</td>
                  <td>(0.17)</td>
                  <td>(0.09)</td>
                </tr>
                <tr>
                  <td>x          </td>
                  <td>0.41  </td>
                  <td>3.28  </td>
                  <td>1.82  </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.02)</td>
                  <td>(0.25)</td>
                  <td>(0.13)</td>
                </tr>
                <tr>
                  <td>control    </td>
                  <td>0.31  </td>
                  <td>2.22  </td>
                  <td>1.26  </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.01)</td>
                  <td>(0.15)</td>
                  <td>(0.08)</td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.419 </td>
                  <td>      </td>
                  <td>      </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Let’s now calculate the effect for each value of the control variable <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. We use the same procedure but we just do it by <code>control</code>. We calculate the difference between the predicted probability for the control and treatment group. We also keep track of the number of observations in each cell. You can see in the printed intermediate calculation that the estimated effect differs for the three different values of the control variable. Because we want a one number summary, we can take the weighted (by number of observation) average of the effect to get the <em>Average Marginal Effect</em>.</p>
<div class="cell" data-hash="interpretation_cache/html/manual-ame-1_4c3753369cd13c6f2388931a76bb2387">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sol_controls <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predictions =</span> <span class="fu">fitted</span>(logit_controls)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prob =</span> <span class="fu">mean</span>(predictions), <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(x, control)) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="fu">c</span>(prob, n), <span class="at">names_from =</span> x) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> prob_1 <span class="sc">-</span> prob_0, <span class="at">n =</span> n_1 <span class="sc">+</span> n_0) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AME =</span> <span class="fu">sum</span>(effect <span class="sc">*</span> n)<span class="sc">/</span><span class="fu">sum</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  control prob_0 prob_1   n_0   n_1 effect     n
    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;int&gt;
1       0 0.119   0.781   148   151  0.662   299
2       1 0.554   0.970   110    93  0.416   203
3      -1 0.0144  0.279   238   261  0.265   499</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    AME
  &lt;dbl&gt;
1 0.414</code></pre>
</div>
</div>
<p>There is another way of doing the calculation. We can also predict the probability assuming that an observation is in the treatment group (<code>pred_x1</code>) and assuming that an observation is in the control group (<code>pred_x2</code>). We can then calculate the <em>Average Marginal Effect</em> as the mean effect within the sample and we get a very similar result.</p>
<div class="cell" data-hash="interpretation_cache/html/manual-ame-2_da35e1a36800c452f6db9c063e263646">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pred_new <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">control =</span> <span class="dv">1</span>){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plogis</span>(<span class="fu">predict</span>(logit_controls, <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">control =</span> control)))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sol_controls <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_x1 =</span> <span class="fu">map_dbl</span>(control, <span class="sc">~</span> <span class="fu">pred_new</span>(<span class="dv">1</span>, ..<span class="dv">1</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pred_x0 =</span> <span class="fu">map_dbl</span>(control, <span class="sc">~</span> <span class="fu">pred_new</span>(<span class="dv">0</span>, ..<span class="dv">1</span>)),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">effect =</span> pred_x1 <span class="sc">-</span> pred_x0) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AME =</span> <span class="fu">mean</span>(effect))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,001 × 6
       x control     y pred_x1 pred_x0 effect
   &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1     0       0     0   0.781  0.119   0.662
 2     0       1     1   0.970  0.554   0.416
 3     1       1     1   0.970  0.554   0.416
 4     0      -1     0   0.279  0.0144  0.265
 5     1      -1     0   0.279  0.0144  0.265
 6     0      -1     0   0.279  0.0144  0.265
 7     0      -1     0   0.279  0.0144  0.265
 8     1      -1     0   0.279  0.0144  0.265
 9     0       1     1   0.970  0.554   0.416
10     0       0     1   0.781  0.119   0.662
# ℹ 991 more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    AME
  &lt;dbl&gt;
1 0.414</code></pre>
</div>
</div>
<p>The last approach is what the <code>avg_comparisons</code> package does. One advantage of the last approach is that it scales better if we have multiple control variables and some of them are continuous. The predictions will account for the heterogeneity in the effect because of the differences in the control variables. The flip side of all of this is that the estimate really depends on the sample. A different sample, with radically different values for the control variables will have a different estimate for the effect of interest.</p>
<div class="cell" data-hash="interpretation_cache/html/AME-controls_3867b75f12a623f774f49fba0173259b">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(logit_controls, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error  z Pr(&gt;|z|)     S 2.5 % 97.5 %
    0.414     0.0218 19   &lt;0.001 264.7 0.371  0.457

Term: x
Type:  response 
Comparison: 1 - 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(probit_controls, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error    z Pr(&gt;|z|)     S 2.5 % 97.5 %
    0.412      0.022 18.7   &lt;0.001 257.2 0.369  0.455

Term: x
Type:  response 
Comparison: 1 - 0</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the linear model <code>ols_controls</code> recovers the average marginal effect directly in the regression. If you are interested in a treatment effect of a treatment compared to a control group, in my opinion, you should just use a linear model with robustly estimated standard errors. The linear model makes it easy to incorporate fixed effects, deal with panel data, and expand the model to two-stage-least-squares or difference-in-differences while giving the estimate that you care about.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The average marginal effect calculation highlights that the effect that we estimate depends on the values of the control variables. As a result, we need to be careful about extrapolating the effect to different settings where the control variables might take different values.</p>
</div>
</div>
<section id="solution-with-continuous-variable" class="level3">
<h3 class="anchored" data-anchor-id="solution-with-continuous-variable">Solution with continuous variable</h3>
<p>The case of a continuous variable <code>x</code> is slightly more complicated because we already know that the relation between the outcome variable <code>y</code> and <code>x</code> is not perfectly linear. However, even with a continuous outcome variable, we also have to make the assumption of a linear relation. However, if we can make the assumption that the relation between <code>y</code> and <code>x</code> is roughly linear, the OLS estimate will be a good approximation of the average marginal effect as we can see below. As before, we can easily incorporate all the benefits of using <code>feols</code> while getting the estimate that we are targeting.</p>
<div class="cell" data-hash="interpretation_cache/html/slopes_f1d9cde3e8ccb34958464d08ddf1c528">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sol_continuous <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">control =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> control)))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>ols_continuous <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_continuous,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">se =</span> <span class="st">"hetero"</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>logit_continuous <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_continuous,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>probit_continuous <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">+</span> control, <span class="at">data =</span> sol_continuous,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(<span class="fu">list</span>(<span class="at">ols =</span> ols_continuous, <span class="at">logit =</span> logit_continuous,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">probit =</span> probit_continuous),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">gof_map =</span> gof_map, <span class="at">fmt =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>
      function styleCell_eg518iw3j96dle7gtes9(i, j, css_id) {
        var table = document.getElementById("tinytable_eg518iw3j96dle7gtes9");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_eg518iw3j96dle7gtes9');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_eg518iw3j96dle7gtes9(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_eg518iw3j96dle7gtes9");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(0, 0, 'tinytable_css_idbycx2fdn552540qlgwnv') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(0, 1, 'tinytable_css_idg0hdtehan2fh9kw5kv16') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(0, 2, 'tinytable_css_idg0hdtehan2fh9kw5kv16') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(0, 3, 'tinytable_css_idg0hdtehan2fh9kw5kv16') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(1, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(1, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(1, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(1, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(2, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(2, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(2, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(2, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(3, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(3, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(3, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(3, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(4, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(4, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(4, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(4, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(5, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(5, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(5, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(5, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(6, 0, 'tinytable_css_idso7jm8clqk82uczv3um0') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(6, 1, 'tinytable_css_id4p4mstdm5mj0dliba5ez') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(6, 2, 'tinytable_css_id4p4mstdm5mj0dliba5ez') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(6, 3, 'tinytable_css_id4p4mstdm5mj0dliba5ez') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(7, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(7, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(7, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(7, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(8, 0, 'tinytable_css_idquqg18pglz37xtqsuo9h') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(8, 1, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(8, 2, 'tinytable_css_ids7euabrsci38an0bwj90') })
window.addEventListener('load', function () { styleCell_eg518iw3j96dle7gtes9(8, 3, 'tinytable_css_ids7euabrsci38an0bwj90') })
    </script>

    <style>
    .table td.tinytable_css_idbycx2fdn552540qlgwnv, .table th.tinytable_css_idbycx2fdn552540qlgwnv {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idg0hdtehan2fh9kw5kv16, .table th.tinytable_css_idg0hdtehan2fh9kw5kv16 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idquqg18pglz37xtqsuo9h, .table th.tinytable_css_idquqg18pglz37xtqsuo9h {  text-align: left; }
    .table td.tinytable_css_ids7euabrsci38an0bwj90, .table th.tinytable_css_ids7euabrsci38an0bwj90 {  text-align: center; }
    .table td.tinytable_css_idso7jm8clqk82uczv3um0, .table th.tinytable_css_idso7jm8clqk82uczv3um0 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id4p4mstdm5mj0dliba5ez, .table th.tinytable_css_id4p4mstdm5mj0dliba5ez {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_eg518iw3j96dle7gtes9" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">ols</th>
                <th scope="col">logit</th>
                <th scope="col">probit</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.29  </td>
                  <td>-1.99 </td>
                  <td>-1.13 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.01)</td>
                  <td>(0.15)</td>
                  <td>(0.08)</td>
                </tr>
                <tr>
                  <td>x          </td>
                  <td>0.26  </td>
                  <td>2.76  </td>
                  <td>1.57  </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.01)</td>
                  <td>(0.19)</td>
                  <td>(0.10)</td>
                </tr>
                <tr>
                  <td>control    </td>
                  <td>0.18  </td>
                  <td>1.79  </td>
                  <td>1.02  </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.01)</td>
                  <td>(0.14)</td>
                  <td>(0.08)</td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1001  </td>
                  <td>1001  </td>
                  <td>1001  </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.445 </td>
                  <td>      </td>
                  <td>      </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>To get the average marginal effect with a continuous <code>x</code>, we use the <code>avg_slopes</code> function from <code>marginaleffects</code>. The function does something similar as <code>avg_comparisons</code> does for the discrete <code>x</code>. It will predict the probability of the outcome <code>y</code> for <code>x</code> and for <code>x + 0.001</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> and then take the difference. In other words, the function will approximate the estimate slope between <code>y</code> and <code>x</code> for each observations. The <em>average marginal effect</em> is again the average for the whole sample.</p>
<p>The fact that the calculation needs to be done for every observation can be a disadvantage of you have a lot of observations and a lot of effects to estimate.</p>
<div class="cell" data-hash="interpretation_cache/html/AME-continuous_d39393905b117fbd2d77a8405f16d1a0">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(logit_continuous, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error  z Pr(&gt;|z|)     S 2.5 % 97.5 %
    0.261    0.00791 33   &lt;0.001 791.3 0.246  0.277

Term: x
Type:  response 
Comparison: dY/dX</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(probit_continuous, <span class="at">variables =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error    z Pr(&gt;|z|)     S 2.5 % 97.5 %
    0.262    0.00782 33.5   &lt;0.001 813.1 0.246  0.277

Term: x
Type:  response 
Comparison: dY/dX</code></pre>
</div>
</div>
<p>All estimates point to the following effect: if <code>x</code> increases by .01, we expect the probability of <code>y</code> to increase by about .25% in our sample.</p>
</section>
</section>
<section id="further-information" class="level2">
<h2 class="anchored" data-anchor-id="further-information">Further information</h2>
<p>There is a lot more that can be done to with marginal effects and they can also be used to estimate non-linear effects in linear models. <a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/">Andrew Heiss</a> has a good overview of the theory and the <a href="https://vincentarelbundock.github.io/marginaleffects/articles/slopes.html"><code>marginaleffects</code> package</a> has excellent vignettes on how to implement the different possibilities.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="math display">\[
\begin{aligned}
p &amp;= \frac{e^z}{1 + e^z} \\
p &amp;= \frac{1}{e^{-z} + 1} \\
\frac{1}{p} &amp;= e^{-z} + 1 \\
\frac{1 - p}{p} &amp;= e^{-z} \\
\frac{p}{1-p} &amp;= e^z \\
\textrm{log}(\frac{p}{1-p}) &amp;= z
\end{aligned}
\]</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is the reason why I used a discrete control variable. It makes all of this a bit easier to illustrate.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>or another amount that can be chosen in the function.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../generalised/introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction and Theory</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../generalised/poisson.html" class="pagination-link">
        <span class="nav-page-text">Poisson Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>